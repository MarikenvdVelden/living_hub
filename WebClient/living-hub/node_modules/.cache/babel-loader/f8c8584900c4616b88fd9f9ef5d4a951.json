{"ast":null,"code":"var _jsxFileName = \"/Users/farzam/Projects/VU Coding/Living Hub/living-hub/src/components/QueryPage.js\";\nimport React from \"react\";\nimport _ from \"lodash\";\nimport TextareaAutosize from \"react-textarea-autosize\";\nimport { connect } from \"react-redux\";\nimport { setDocuments, setQueryString } from \"../actions\";\nimport { Grid, Input, Container, Divider, Segment, Button, Form, Icon } from \"semantic-ui-react\";\nimport Records from \"./Records\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass QueryPage extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.runQuery = () => {\n      this.props.session.postQuery(this.props.index, this.props.queryString, // this.fields,\n      \"\", \"2m\", 100, {}, { ...this.prepareFilters()\n      }).then(res => {\n        this.props.setDocuments(res.data.results);\n      }).catch(e => {\n        console.log(e);\n      });\n      return null;\n    };\n  }\n\n  prepareFilters() {\n    this.setState({\n      queryMethod: \"POST\"\n    });\n    const obj = {};\n    const dateFilter = {\n      range: {}\n    };\n    Object.entries(this.props.filters).map(filter => {\n      if (filter[0] === \"date\") {\n        for (const [rangeIndicator, value] of Object.entries(filter[1])) {\n          if (value === null || value === \"\") {\n            console.log(\"here\");\n            dateFilter.range = _.omit(dateFilter.range, rangeIndicator);\n          } else dateFilter.range[rangeIndicator] = value;\n        }\n\n        obj[\"date\"] = dateFilter;\n      } else {\n        obj[filter[0]] = {\n          value: filter[1]\n        };\n      }\n\n      return obj;\n    });\n    return obj;\n  }\n\n  renderQueryWindow() {\n    return /*#__PURE__*/_jsxDEV(Segment, {\n      style: {\n        border: \"0\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(Form, {\n        style: {\n          marginBottom: \"2em\"\n        },\n        children: /*#__PURE__*/_jsxDEV(TextareaAutosize, {\n          width: 16,\n          value: this.props.queryString ? this.props.queryString : \"\",\n          style: {\n            height: 20\n          },\n          placeholder: \"Query...\",\n          onChange: e => this.props.setQueryString(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        style: {\n          marginBottom: \"2em\"\n        },\n        children: this.renderFilters()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        children: /*#__PURE__*/_jsxDEV(Button.Group, {\n          widths: \"2\",\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            primary: true,\n            type: \"submit\",\n            onClick: () => this.runQuery(this.state.queryMethod),\n            children: [/*#__PURE__*/_jsxDEV(Icon, {\n              name: \"search\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 15\n            }, this), \"Execute Query\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this);\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Container, {\n      children: /*#__PURE__*/_jsxDEV(Grid, {\n        children: /*#__PURE__*/_jsxDEV(Grid.Column, {\n          width: 16,\n          children: [/*#__PURE__*/_jsxDEV(Grid.Row, {\n            children: this.renderQueryWindow()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Grid.Row, {\n            children: /*#__PURE__*/_jsxDEV(Records, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 104,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    session: state.session,\n    index: state.index,\n    fields: state.indexFields,\n    filters: state.fieldValues,\n    queryString: state.queryString,\n    documents: state.documents\n  };\n};\n\nexport default connect(mapStateToProps, {\n  setDocuments,\n  setQueryString\n})(QueryPage);","map":{"version":3,"sources":["/Users/farzam/Projects/VU Coding/Living Hub/living-hub/src/components/QueryPage.js"],"names":["React","_","TextareaAutosize","connect","setDocuments","setQueryString","Grid","Input","Container","Divider","Segment","Button","Form","Icon","Records","QueryPage","Component","runQuery","props","session","postQuery","index","queryString","prepareFilters","then","res","data","results","catch","e","console","log","setState","queryMethod","obj","dateFilter","range","Object","entries","filters","map","filter","rangeIndicator","value","omit","renderQueryWindow","border","marginBottom","height","target","renderFilters","state","render","mapStateToProps","fields","indexFields","fieldValues","documents"],"mappings":"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","sourcesContent":["import React from \"react\";\n\nimport _ from \"lodash\";\nimport TextareaAutosize from \"react-textarea-autosize\";\nimport { connect } from \"react-redux\";\nimport { setDocuments, setQueryString } from \"../actions\";\n\nimport {\n  Grid,\n  Input,\n  Container,\n  Divider,\n  Segment,\n  Button,\n  Form,\n  Icon,\n} from \"semantic-ui-react\";\nimport Records from \"./Records\";\n\nclass QueryPage extends React.Component {\n  prepareFilters() {\n    this.setState({\n      queryMethod: \"POST\",\n    });\n    const obj = {};\n    const dateFilter = {\n      range: {},\n    };\n    Object.entries(this.props.filters).map((filter) => {\n      if (filter[0] === \"date\") {\n        for (const [rangeIndicator, value] of Object.entries(filter[1])) {\n          if (value === null || value === \"\") {\n            console.log(\"here\");\n            dateFilter.range = _.omit(dateFilter.range, rangeIndicator);\n          } else dateFilter.range[rangeIndicator] = value;\n        }\n        obj[\"date\"] = dateFilter;\n      } else {\n        obj[filter[0]] = { value: filter[1] };\n      }\n      return obj;\n    });\n    return obj;\n  }\n\n  runQuery = () => {\n    this.props.session\n      .postQuery(\n        this.props.index,\n        this.props.queryString,\n        // this.fields,\n        \"\",\n        \"2m\",\n        100,\n        {},\n        { ...this.prepareFilters() }\n      )\n      .then((res) => {\n        this.props.setDocuments(res.data.results);\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n    return null;\n  };\n\n  renderQueryWindow() {\n    return (\n      <Segment style={{ border: \"0\" }}>\n        <Form style={{ marginBottom: \"2em\" }}>\n          <TextareaAutosize\n            width={16}\n            value={this.props.queryString ? this.props.queryString : \"\"}\n            style={{ height: 20 }}\n            placeholder=\"Query...\"\n            onChange={(e) => this.props.setQueryString(e.target.value)}\n          />\n        </Form>\n        <Form style={{ marginBottom: \"2em\" }}>{this.renderFilters()}</Form>\n        <Form>\n          <Button.Group widths=\"2\">\n            <Button\n              primary\n              type=\"submit\"\n              onClick={() => this.runQuery(this.state.queryMethod)}\n            >\n              <Icon name=\"search\" />\n              Execute Query\n            </Button>\n          </Button.Group>\n        </Form>\n      </Segment>\n    );\n  }\n\n  render() {\n    return (\n      <Container>\n        <Grid>\n          <Grid.Column width={16}>\n            <Grid.Row>{this.renderQueryWindow()}</Grid.Row>\n            <Divider />\n            <Grid.Row>\n              <Records />\n            </Grid.Row>\n          </Grid.Column>\n        </Grid>\n      </Container>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    session: state.session,\n    index: state.index,\n    fields: state.indexFields,\n    filters: state.fieldValues,\n    queryString: state.queryString,\n    documents: state.documents,\n  };\n};\n\nexport default connect(mapStateToProps, { setDocuments, setQueryString })(\n  QueryPage\n);\n"]},"metadata":{},"sourceType":"module"}